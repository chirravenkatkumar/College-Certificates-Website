<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload PDF and Select Coordinates</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.css"/>
</head>
<body>
    <div class="dashboard-container">
        <h1>Upload PDF and Select Coordinates</h1>
        <form id="positionSelectionForm" action="/admin_Dashboard/uploadCertificates" method="post" enctype="multipart/form-data">
            <input type="file" id="pdfFileInput" name="pdfFileInput" accept=".pdf" required>
            <button type="button" id="uploadPdfButton">Upload PDF File</button>
            <button type="submit" id="submitButton" name="submitButton">Submit</button>
        </form>
        <div id="selectedCoordinatesPreview" style="display: none;">
            <h2>Selected Coordinates:</h2>
            <ul id="coordinatesList"></ul>
        </div>
    </div>
    <iframe id="pdfViewer" style="width: 100%; height: 500px; border: 1px solid black;"></iframe>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.min.js"></script>
    <script>
        var positions = {};
        var pdfFile = null;
        var pdfViewer = document.getElementById('pdfViewer');

        document.getElementById('uploadPdfButton').addEventListener('click', function() {
            document.getElementById('pdfFileInput').click();
        });

        document.getElementById('pdfFileInput').addEventListener('change', function(event) {
            pdfFile = event.target.files[0];
            if (pdfFile) {
                renderPdf();
            }
        });

        async function renderPdf() {
            pdfViewer.src = 'https://mozilla.github.io/pdf.js/web/viewer.html?file=' + encodeURIComponent(URL.createObjectURL(pdfFile));
            pdfViewer.onload = function() {
                var iframeDocument = pdfViewer.contentDocument || pdfViewer.contentWindow.document;
                iframeDocument.addEventListener('click', function(event) {
                    var rect = pdfViewer.getBoundingClientRect();
                    var x = event.clientX - rect.left;
                    var y = event.clientY - rect.top;
                    positions['Selected Point'] = { x: x, y: y };
                    updateCoordinatesList();
                });
            };
        }

        function updateCoordinatesList() {
            var coordinatesList = document.getElementById('coordinatesList');
            coordinatesList.innerHTML = ''; // Clear previous coordinates
            Object.keys(positions).forEach(function(key) {
                var listItem = document.createElement('li');
                listItem.textContent = key + ': (' + positions[key].x + ', ' + positions[key].y + ')';
                coordinatesList.appendChild(listItem);
            });
            document.getElementById('selectedCoordinatesPreview').style.display = 'block'; // Show coordinates preview
        }
    </script>    
</body>
</html>
